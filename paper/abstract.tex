Model-based control techniques have been widely used over the past years in control systems to improve system performance of simple controllers, such as PID, bang-bang, etc. Among these, one of the most popular is Model Predictive Control (MPC), due to its capacity to optimally control a system, based on the capability to predict its behavior over a future horizon. A key factor prohibiting the widespread adoption of MPC for complex systems is related to the difficulties (cost, time, and effort) associated with the model identification. Data-driven models have been intensively studied in the last year to overcome this problem. However, closed-loop control systems based on such models have not received much attention. We introduce a novel idea for predictive control based on system data, Data Predictive Control (DPC), leveraging machine learning algorithms, in particular regression trees and random forests. We show, using a bilinear model, that DPC has comparable performance with MPC. We further apply DPC to the Demand Response problem of a large scale multi-story EnergyPlus building model, and show that DPC curtails the desired power usage with high confidence. Finally, we use DPC to optimize ON/OFF scheduling of the heating system of a real house in order to minimize the power consumption while guaranteeing thermal comfort for occupants. Our results show that with DPC we obtain an energy saving in terms of $kWh$ that goes from $25.4\%$ to $49.2\%$ when compared to a bang-bang controller.